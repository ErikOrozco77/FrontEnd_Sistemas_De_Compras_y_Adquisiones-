<title>Concurso: {{nombreConcurso }}</title>
<mat-toolbar class="red-toolbar custom-toolbar">
  <div class="logo-container">
    <img src="https://stjcolima.gob.mx/assets/img/logo_stj.png" alt="Logo" class="logo-img">
  </div>
  <div>
    <button mat-icon-button (click)="navigateToMenu()" aria-label="Home">
      <mat-icon>keyboard_backspace</mat-icon>
    </button>
  </div>
</mat-toolbar>
<br>
<mat-toolbar class="gr-toolbar">
  <span class="mat-h2">Selecciona a los proveedores concursantes</span>

</mat-toolbar>
<mat-card-content class="center-content">
  Concurso: {{nombreConcurso }}
</mat-card-content>
<br>
<div style="display: flex; justify-content: center;">
  <mat-form-field appearance="fill" class="search-field" style="width: 10%;">
    <mat-label>Buscar</mat-label>
    <input matInput (keyup)="applyFilter($event)" class="busqueda-search-input" placeholder="Ingrese su búsqueda">
  </mat-form-field>
</div>
<div style="display: flex; justify-content: space-between;">
  <div class="table-container-left">
    <div class="available-providers">
      <div *ngIf="proveedores && proveedores.length > 0">
        <h1></h1>
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

          <ng-container matColumnDef="id">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Id</th>
            <td mat-cell *matCellDef="let proveedor;let i = index" style="text-align: center;" (click)="onRowClicked(i)"
              (mouseenter)="onMouseEnterRow(i)" (mouseleave)="onMouseLeaveRow(i)"
              [ngClass]="{ 'highlighted-row': i === selectedRowIndex }"> {{ proveedor.id }} </td>
          </ng-container>

          <ng-container matColumnDef="nombre">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.nombre }} </td>
          </ng-container>

          <ng-container matColumnDef="primerApellido">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Primer Apellido </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.primerApellido }} </td>
          </ng-container>

          <ng-container matColumnDef="segundoApellido">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Segundo Apellido </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.segundoApellido }} </td>
          </ng-container>

          <ng-container matColumnDef="razonSocial">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Razon Social </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.razonSocial }} </td>
          </ng-container>

          <ng-container matColumnDef="estratificacion">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Estratificación </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.estratificacion }} </td>
          </ng-container>

          <ng-container matColumnDef="paisOrigen">
            <th mat-header-cell *matHeaderCellDef> Pais de Origen </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.paisOrigen }} </td>
          </ng-container>

          <ng-container matColumnDef="rfc">
            <th mat-header-cell *matHeaderCellDef> RFC </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.rfc }} </td>
          </ng-container>

          <ng-container matColumnDef="actividadEconomica">
            <th mat-header-cell *matHeaderCellDef> Actividad Economica </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.actividadEconomica }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNombre">
            <th mat-header-cell *matHeaderCellDef> Domicilio </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNombre }} </td>
          </ng-container>

          <ng-container matColumnDef="catGiro">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Giro </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.CatGiro?.descripcion }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNumeroExterior">
            <th mat-header-cell *matHeaderCellDef> N° Exterior </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNumeroExterior }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNumeroInterior">
            <th mat-header-cell *matHeaderCellDef> N° Interior </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNumeroInterior }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNombreAsentamiento">
            <th mat-header-cell *matHeaderCellDef> Asentamiento </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNombreAsentamiento }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioClaveLocalidad">
            <th mat-header-cell *matHeaderCellDef> Clave de Localidad </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioClaveLocalidad }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNombreLocalidad">
            <th mat-header-cell *matHeaderCellDef> Nombre de la localidad </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNombreLocalidad }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioClaveMunicipio">
            <th mat-header-cell *matHeaderCellDef> Clave del Municipio </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioClaveMunicipio }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioNombreMunicipio">
            <th mat-header-cell *matHeaderCellDef> Nombre del Municipio </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioNombreMunicipio }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioClaveEntidad">
            <th mat-header-cell *matHeaderCellDef> Clave de la Entidad </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioClaveEntidad }} </td>
          </ng-container>

          <ng-container matColumnDef="domicilioCP">
            <th mat-header-cell *matHeaderCellDef> Codigo Postal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.domicilioCP }} </td>
          </ng-container>

          <ng-container matColumnDef="extranjeroPais">
            <th mat-header-cell *matHeaderCellDef> Pais Extranjero </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.extranjeroPais }} </td>
          </ng-container>

          <ng-container matColumnDef="extranjeroCiudad">
            <th mat-header-cell *matHeaderCellDef> Ciudad Extranjera </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.extranjeroCiudad }} </td>
          </ng-container>

          <ng-container matColumnDef="extranjeroCalle">
            <th mat-header-cell *matHeaderCellDef> Calle Extranjera </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.extranjeroCalle }} </td>
          </ng-container>

          <ng-container matColumnDef="extranjeroNumero">
            <th mat-header-cell *matHeaderCellDef> Numero Extranjero </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.extranjeroNumero }} </td>
          </ng-container>

          <ng-container matColumnDef="representanteLegalNombre">
            <th mat-header-cell *matHeaderCellDef> Nombre del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.representanteLegalNombre }} </td>
          </ng-container>

          <ng-container matColumnDef="representanteLegalPrimerApellido">
            <th mat-header-cell *matHeaderCellDef> Primer Apellido del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.representanteLegalPrimerApellido }} </td>
          </ng-container>

          <ng-container matColumnDef="representanteLegalSegundoApellido">
            <th mat-header-cell *matHeaderCellDef> Segundo Apellido del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.representanteLegalSegundoApellido }} </td>
          </ng-container>

          <ng-container matColumnDef="representanteLegalTelefono">
            <th mat-header-cell *matHeaderCellDef> Telefono del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.representanteLegalTelefono }} </td>
          </ng-container>

          <ng-container matColumnDef="representanteLegalMail">
            <th class="sticky-header" mat-header-cell *matHeaderCellDef> Email del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.representanteLegalMail }} </td>
          </ng-container>

          <ng-container matColumnDef="website">
            <th mat-header-cell *matHeaderCellDef> Sitio Web </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.website }} </td>
          </ng-container>

          <ng-container matColumnDef="telefono">
            <th mat-header-cell *matHeaderCellDef> Telefono </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.telefono }} </td>
          </ng-container>

          <ng-container matColumnDef="catSexo">
            <th mat-header-cell *matHeaderCellDef> Sexo </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catSexo }} </td>
          </ng-container>

          <ng-container matColumnDef="catOrigenId">
            <th mat-header-cell *matHeaderCellDef> Origen </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catOrigenId }} </td>
          </ng-container>

          <ng-container matColumnDef="catEntidadFederativaId">
            <th mat-header-cell *matHeaderCellDef> Entidad Federativa </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catEntidadFederativaId }} </td>
          </ng-container>

          <ng-container matColumnDef="catRealizaSubcontratacionesId">
            <th mat-header-cell *matHeaderCellDef> Subcontrataciones </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catRealizaSubcontratacionesId }} </td>
          </ng-container>

          <ng-container matColumnDef="catDomicilioVialidadId">
            <th mat-header-cell *matHeaderCellDef> Domicilio Vialidad </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catDomicilioVialidadId }} </td>
          </ng-container>

          <ng-container matColumnDef="catDomicilioTipoAsentamientoId">
            <th mat-header-cell *matHeaderCellDef> Tipo de Asentamiento </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catDomicilioTipoAsentamientoId }} </td>
          </ng-container>

          <ng-container matColumnDef="catDomicilioEntidadFederativaId">
            <th mat-header-cell *matHeaderCellDef> Domicilio Entidad Federativa </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catDomicilioEntidadFederativaId }} </td>
          </ng-container>

          <ng-container matColumnDef="catRepresentanteLegalTipoAcreditacionId">
            <th mat-header-cell *matHeaderCellDef> Tipo de Acreditación del Representante Legal </th>
            <td mat-cell *matCellDef="let proveedor"> {{ proveedor.catRepresentanteLegalTipoAcreditacionId }} </td>
          </ng-container>



          <tr mat-row (click)="onRowClicked(row)" *matRowDef="let row; columns: displayedColumns;"></tr>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row [ngClass]="{'row-hovered': isHovered(proveedor)}" (mouseenter)="onMouseEnter(proveedor)"
            (mouseleave)="onMouseLeave()" (click)="onRowClicked(proveedor)"
            *matRowDef="let proveedor; columns: displayedColumns;"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

          <tr mat-row [ngClass]="{'row-hovered': isHovered(proveedor)}" (mouseenter)="onMouseEnter(proveedor)"
            (mouseleave)="onMouseLeave()" *matRowDef="let proveedor; columns: displayedColumns;">
          </tr>
        </table>

      </div>
    </div>
  </div>

  <div class="table-container-right">
    <mat-card *ngIf="proveedoresSeleccionados.length > 0" class="selected-proveedores-card">
      <br>
      <h4>Proveedores Seleccionados:</h4>
      <ul class="selected-proveedores-list">
        <li *ngFor="let proveedor of proveedoresSeleccionados" class="selected-proveedores-item">
          {{ proveedor.nombre }} {{ proveedor.primerApellido }} {{ proveedor.segundoApellido }}/{{ proveedor.rfc}}/{{
          proveedor.representanteLegalMail}}/{{ proveedor.telefono}}
          <button (click)="eliminarProveedorSeleccionado(proveedor)" class="eliminar-button">
            <mat-icon>clear</mat-icon>
          </button>
        </li>
      </ul>
    </mat-card>
    <div class="button-container text-center" *ngIf="proveedoresSeleccionados.length > 0">
      <button mat-raised-button style="background-color: brown; color: white;" class="custom-button"
        (click)="enviarProveedoresSeleccionados()">Enviar Proveedores Seleccionados</button>
      <div *ngIf="enviandoCorreo" class="loading-overlay">
        <mat-spinner></mat-spinner>
      </div>
    </div>
    <div *ngIf="!proveedores">
      <p>Cargando proveedores...</p>
    </div>

    <div *ngIf="proveedores && proveedores.length === 0">
      <p>No hay proveedores disponibles.</p>
    </div>
  </div>
</div>